<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>İçerik</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="assets/style.css" />
</head>
<body>

<style>
  body { display: none; }

  .content-wrapper {
    max-width: var(--max-width);
    margin: 3rem auto;
    padding: 0 1.5rem;
  }

  .book-cover {
    width: 100%;
    max-height: 360px;
    object-fit: cover;
    border-radius: var(--radius);
    margin-bottom: 1.5rem;
    box-shadow: var(--shadow-soft);
  }

  .book-meta {
    color: var(--muted);
    font-size: 0.9rem;
    margin-bottom: 1rem;
  }

  .book-desc {
    color: var(--muted);
    margin-bottom: 1.5rem;
    line-height: 1.6;
  }

  .book-full {
    color: var(--text);
    line-height: 1.7;
    white-space: pre-line;
    font-size: 1rem;
  }
</style>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
  import { 
    getAuth, 
    onAuthStateChanged 
  } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";

  import {
    getFirestore,
    doc,
    getDoc
  } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD_0Y9D2ljwwC7pHmaYTrbwc677kwIUrgQ",
    authDomain: "isahalis.firebaseapp.com",
    projectId: "isahalis",
    storageBucket: "isahalis.firebasestorage.app",
    messagingSenderId: "33060832531",
    appId: "1:33060832531:web:31cdc1598686be16aa06e6",
    measurementId: "G-2N25T885EH"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // URL'den ID alma
  const params = new URLSearchParams(window.location.search);
  const bookID = params.get("id");

  if (!bookID) {
    document.body.innerHTML = "<p style='padding:2rem;'>Geçersiz içerik ID.</p>";
  }

  // İçeriği yükleme
  async function loadBook() {
    const ref = doc(db, "books", bookID);
    const snap = await getDoc(ref);

    if (!snap.exists()) {
      document.body.innerHTML = "<p style='padding:2rem;'>İçerik bulunamadı.</p>";
      return;
    }

    const b = snap.data();

    document.getElementById("bookTitle").innerText = b.title;
    document.getElementById("bookCover").src = b.cover || "assets/placeholder.jpg";
    document.getElementById("bookDesc").innerText = b.desc || "";
    document.getElementById("bookFull").innerText = b.fullText || "";
    document.getElementById("bookMeta").innerText =
      `${new Date(b.createdAt).toLocaleDateString()} • ${b.category}`;
    
    document.body.style.display = "block";
  }

  loadBook();
</script>

<header class="site-header">
  <div class="logo">İsa Halis</div>
  <nav class="nav">
    <a href="index.html">Ana Sayfa</a>
    <a href="books.html">Kitaplarım</a>
    <a href="about.html">Hakkımda</a>
    <a href="contact.html">İletişim</a>
  </nav>
</header>

<main class="content-wrapper">
  <img id="bookCover" class="book-cover" />

  <h1 id="bookTitle"></h1>

  <div id="bookMeta" class="book-meta"></div>

  <div id="bookDesc" class="book-desc"></div>

  <div id="bookFull" class="book-full"></div>
</main>

<footer class="site-footer">
  <p>© <span id="year"></span> İsa Halis</p>
</footer>

<script>
  document.getElementById("year").textContent = new Date().getFullYear();
</script>

</body>
</html>
