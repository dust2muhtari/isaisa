<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Ana Sayfa | M. Furkan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="assets/style.css" />
</head>
<body>

<header class="site-header">
  <div class="logo">M. Furkan</div>
  <nav class="nav" id="nav-menu">
    <!-- MenÃ¼ elemanlarÄ± JS ile doldurulacak -->
  </nav>
</header>

<main class="section">
  <h1>HoÅŸ Geldiniz</h1>
  <p>Bu site M. Furkanâ€™Ä±n kitaplarÄ±nÄ±, yazÄ±larÄ±nÄ± ve projelerini iÃ§erir.</p>
</main>

<footer class="site-footer">
  <p>Â© <span id="year"></span> M. Furkan</p>
</footer>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
  import { 
    getAuth, 
    onAuthStateChanged, 
    signOut 
  } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";

  import {
    getFirestore,
    doc,
    getDoc
  } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD_0Y9D2ljwwC7pHmaYTrbwc677kwIUrgQ",
    authDomain: "isahalis.firebaseapp.com",
    projectId: "isahalis",
    storageBucket: "isahalis.firebasestorage.app",
    messagingSenderId: "33060832531",
    appId: "1:33060832531:web:31cdc1598686be16aa06e6",
    measurementId: "G-2N25T885EH"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const nav = document.getElementById("nav-menu");

  // ğŸ”¥ KullanÄ±cÄ± giriÅŸ kontrolÃ¼
  onAuthStateChanged(auth, async (user) => {
    nav.innerHTML = ""; // MenÃ¼ temizle

    // Herkese gÃ¶rÃ¼nen menÃ¼
    nav.innerHTML += `
      <a href="index.html">Ana Sayfa</a>
      <a href="books.html">KitaplarÄ±m</a>
      <a href="about.html">HakkÄ±mda</a>
      <a href="contact.html">Ä°letiÅŸim</a>
    `;

    if (user) {
      // KullanÄ±cÄ± belgesini Ã§ek
      const ref = doc(db, "users", user.uid);
      const snap = await getDoc(ref);
      const role = snap.exists() ? snap.data().role : "user";

      // Profil butonu
      nav.innerHTML += `<a href="profile.html">Profilim</a>`;

      // EÄŸer editor ise ek menÃ¼ler
      if (role === "editor") {
        nav.innerHTML += `<a href="editor.html">Editor Paneli</a>`;
        nav.innerHTML += `<a href="admin.html">Admin Paneli</a>`;
      }

      // Ã‡Ä±kÄ±ÅŸ butonu
      nav.innerHTML += `<button onclick="logout()" class="btn-secondary">Ã‡Ä±kÄ±ÅŸ Yap</button>`;

    } else {
      // GiriÅŸ yapmamÄ±ÅŸ kullanÄ±cÄ±
      nav.innerHTML += `<a href="login.html">GiriÅŸ Yap</a>`;
    }
  });

  // Ã‡Ä±kÄ±ÅŸ fonksiyonu
  window.logout = function () {
    signOut(auth).then(() => {
      window.location.href = "index.html";
    });
  };
</script>

</body>
</html>
